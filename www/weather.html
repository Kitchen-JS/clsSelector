<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset = "UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>T3 Tailwind Theme</title>

    <meta name="language" content="EN">

    <link rel="stylesheet" type="text/css" href="/content/fonts/pfi.css">
    <link rel="stylesheet" type="text/css" href="/content/css/tailwindTheme.css">

    <script src="/content/fonts/pfi.js"></script>
    <script src="/content/js/tailwind.js"></script>  
  </head>
  <body>
    <div class="windowContainer" style="width: 100%;"></div>
    <div id="BodyContent" class="w-full h-full">


      <div class="wx-wrapper">

        <div class="wx-icon-container">
          <i class="pfi-wx-cold"></i>
        </div>

        <div class="wx-icon-container">
          <i class="pfi-wx-cloud"></i>
          <i class="pfi-wx-sunny"></i>
        </div>

        <div class="wx-icon-container">
          <i class="pfi-wx-cloud"></i>
        </div>

        <div class="wx-icon-container">
          <i class="pfi-wx-sunny"></i>
        </div>

        <div class="wx-icon-container">
          <i class="pfi-wx-cloud"></i>
          <i class="pfi-wx-sunny"></i>
          <i class="pfi-wx-cold"></i>
        </div>
      </div>

      <br /><br />
      <button class="button bg-slate-500 border border-black rounded-sm text-white w-24">Add</button>

    </div>

    <script>
      document.querySelector('button').addEventListener('click', () =>
      {
        let cntr = document.createElement('div');
        cntr.classList.add('wx-icon-container');
        cntr.innerHTML = `<i class="pfi-wx-cloud"></i>
          <i class="pfi-wx-cold"></i>`;
        document.querySelector('.wx-wrapper').appendChild(cntr);
      });

      function weatherIconSizeFunc()
      {
        let iconContainers = document.querySelectorAll('.wx-icon-container');
        iconContainers = Array.from(iconContainers);

        iconContainers.forEach((ic) =>
        {
          let icons = ic.querySelectorAll('i');
          let ic_ctr = icons.length;

          Array.from(icons).forEach((icon) =>
          {
            let sz = icon.parentElement.clientWidth > icon.parentElement.clientHeight ? icon.parentElement.clientWidth : icon.parentElement.clientHeight;
            //console.log(sz)
            sz = (sz / ic_ctr) * .80;
            icon.style.fontSize = `${sz}px`;
          });
        });
      }

      function domObserver()
      {
        const targetNode = document.querySelector('body');
        const config = { attributes: false, childList: true, subtree: true };
        const callback = (mutationList, observer) => 
        {
          for (const mutation of mutationList) 
          {
            if (mutation.type === "childList") 
            {
              weatherIconSizeFunc();
              console.log("A child node has been added or removed.");
            }
          }
        };
        const observer = new MutationObserver(callback);
        observer.observe(targetNode, config);
      }

      window.addEventListener("load", (event) => 
      {
        console.log('load')
        domObserver();
        weatherIconSizeFunc();
      });

      window.addEventListener('resize', () =>
      {
        console.log('resize')
        weatherIconSizeFunc();
      });

      //weatherIconSizeFunc();
      
    </script>
  </body>
</html>